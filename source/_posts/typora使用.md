---
title: typora使用
date: 2020-11-20 10:53:23
tags: markdown
categories: 工具
---

安利下 [typora](https://typora.io/) 这个markdown编辑工具

<!--more-->

界面简洁,功能强大

对于普通的markdown语法不在描述,不过我迷上了**写**流程图,为什么是写流程图不是画,是因为真的就是写出来的图

直接上用例

### 时序图



```mermaid
sequenceDiagram
loop 定时任务
达美乐tracker系统 ->> 聚合服务 : 拉单(外送单)
end
聚合服务 ->> 聚合服务 : 通过mq实现延迟推送
聚合服务 ->> 配送服务: 推单
配送服务 ->> 配送服务: 自配送
配送服务 ->> 顺丰服务 : 推送运单
顺丰服务 -->> 配送服务 : 状态回调
配送服务 -->> 聚合服务 : 状态回调
聚合服务 -->> 达美乐plus系统 : plus回报
```

对应的实际效果图:

![avatar](https://raw.githubusercontent.com/zizi0425/gradledemo/master/docs/picture/时序图.png)





### 来自我们产品漂亮的时序图

```mermaid
sequenceDiagram
顾客->>tracker: 下单
loop 正向流程
配送系统->>tracker: 一分钟拉取一次订单
tracker-->>配送系统: 拉取到`存餐状态`订单
配送系统->>tracker: 一分钟拉取一次订单，获取`取餐码`、`取餐柜订单号`、`柜号`
tracker-->>配送系统: 返回
配送系统->>骑手APP: 信鸽推送`取餐码`、`取餐柜订单号`和`柜号`
骑手APP->>配送系统: 一键取餐
配送系统->>东城: 拿`取餐柜订单号`、`验签信息`开柜取餐（接口：`5. 远程开箱`）
东城-->>配送系统:取餐成功
配送系统-->>骑手APP: 更新取餐状态（取餐成功，置灰）
配送系统->>配送系统: 第三方骑手接单，获取骑手手机号
配送系统->>EC短信平台: 短信推送`取餐码`和`柜号`给第三方骑手手机号
EC短信平台->>第三方骑手:通知`取餐码`、`柜号`
第三方骑手->>东城:拿`取餐码`取餐
loop 线下的东城校验流程
东城-->>东城:拿`取餐码`开柜取餐，返回成功与否
end
东城-->>第三方骑手:开柜成功&失败
end
loop 逆向流程
tracker-->>配送系统: 拉取到`取消存餐状态`订单
配送系统->>EC短信平台: 短信通知给第三方骑手手机号
EC短信平台->>第三方骑手:通知骑手取消存餐
配送系统->>骑手APP: 信鸽推送取消存餐，一键取餐按钮置灰
骑手APP->>配送系统: 一键取餐（停留在订单页面未离开）
配送系统-->>东城: 拿`取餐柜订单号`、`验签信息`开柜取餐（接口：`5. 远程开箱`）
东城-->>配送系统:取餐失败
配送系统-->>骑手APP: 取餐失败，更新按钮`置灰`
end
loop 补偿流程
骑手APP->>配送系统:开始配送
配送系统-->>配送系统: 判断当前批次已`一键取餐`
配送系统-->>骑手APP: 开始配送成功，当前批次进入配送中
配送系统-->>配送系统: 判断当前批次有运单未`一键取餐`
配送系统-->>骑手APP: 开始配送失败，提示：`还有订单未取餐，请先取餐`
end
```

实际效果(图太大,截不了全图,可以自己试试):



![avatar](https://raw.githubusercontent.com/zizi0425/gradledemo/master/docs/时序图2.png)

### 流程图

``` mermaid


graph TD
新运单 --> 首次分配
首次分配 -- 空闲骑手 --> FIRST[直接分配] --> 结束
首次分配 -- 待单数之内 --> 创建新的批次或者并单 --> 结束
首次分配 -- 待单数之外 --> 顺丰 -- 配送方案最长接单时间 --> 取消创建新运单推送自配送
--空闲骑手--> SECOND[直接分配]--> 结束
取消创建新运单推送自配送 -- 可以并单 --> 直接并入批次--> 结束
取消创建新运单推送自配送 -- 不可以并单 --> 创建新的批次 --> 结束

```

这张图确实丑了点,嗯,我现在还不熟练,但是这个流程称得上很清晰了



![avatar](https://raw.githubusercontent.com/zizi0425/gradledemo/master/docs/picture/流程图.png)

